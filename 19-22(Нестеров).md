### Глава 19. Изменение служб

**Изменение служб**

Перевод пользователей на новую службу — важная задача системных администраторов. Это может потребоваться из-за устаревания системы, слияния компаний или других причин. Главное — сделать переход плавным и незаметным для пользователей.

**Невидимое изменение**

Успех зависит от минимального вмешательства в работу пользователей. Пример: разделение Bell Labs и Lucent от AT&T прошло незаметно для исследователей.

**19.1 Основы**

Ключ к успеху — надежная инфраструктура и постепенное внедрение изменений. Начинайте с системных администраторов, затем переходите к широкому кругу пользователей. Важно иметь план отката на случай проблем.

Автоматизированные системы обновления упрощают процесс. Заранее информируйте пользователей и учитывайте их мнения. Грамотное планирование минимизирует негативное влияние.

**Минимизируйте вмешательство**

Планируйте изменения так, чтобы минимизировать их влияние на пользователей. Определите, нужно ли прерывать работу службы и как сократить время недоступности. Подготовьте обучение для пользователей, если требуется изменение клиентского ПО. Стремитесь к переходу без прерывания работы и обеспечьте поддержку.

**Горизонтально или вертикально**

Задачи можно выполнять горизонтально (одна задача для всех пользователей) или вертикально (все задачи для каждого пользователя). Горизонтальный подход подходит для задач без вмешательства, вертикальный — для задач с вмешательством.

**Распространение информации**

Заранее информируйте пользователей о предстоящих изменениях. Это поможет выявить непредвиденные способы использования системы и учесть потребности пользователей.

**Обучение**

Обучение пользователей важно, если их работа изменится. Для крупных систем обучение критично. Системные администраторы могут поддерживать организацию обучения, взаимодействуя с пользователями, разработчиками и руководством.

**Начинайте с небольших групп**

Вводите изменения постепенно. Тестируйте на собственных системах, затем привлекайте коллег и пользователей, готовых столкнуться с возможными сложностями.

**Мгновенные изменения: делать все сразу**

Избегайте одномоментного перехода всей компании. Постепенный переход снижает риски. Если нужно внедрить изменения сразу, заранее предусмотрите бюджет на дублирующие ресурсы.

**План отмены**

План отмены важен для возврата к исходному состоянию при проблемах. Мгновенный откат позволяет быстро вернуть систему в исходное состояние. План отмены должен быть готов к использованию в течение некоторого времени.

**Тонкости**

Мгновенный откат позволяет быстро вернуть систему в исходное состояние при ошибках. Планирование помогает избежать частых изменений. Используйте DNS для перенаправления трафика или символические ссылки для переключения версий ПО.

**Изменения веб-служб**

Обновление сервера веб-службы редко требует обновления клиентского ПО, так как служба работает через веб-браузер. Веб-службы должны поддерживать все браузеры и устройства.

**Поддержка разработчиков**

При внедрении масштабных изменений важно заручиться поддержкой разработчика. Обсудите возможные препятствия и заранее поделитесь планами с разработчиком.

**Заключение**

Успешный переход требует тщательного планирования и надежной инфраструктуры. Минимизируйте воздействие изменений на пользователей и обеспечьте плавный переход.

### Глава 20. Технические перерывы

Технические перерывы необходимы для обслуживания систем. Важно тщательно планировать и координировать эти перерывы, чтобы минимизировать влияние на пользователей.

**20.1 Основы**

Технический перерыв — это время для обслуживания систем. Важно согласовать даты с компанией и заранее опубликовать график перерывов.

**20.1.1 Планирование времени**

Избегайте перерывов в конце месяца, квартала и финансового года. Учитывайте сезонные ограничения и заранее опубликуйте график перерывов.

**20.1.2 Планирование**

Системные администраторы должны заранее планировать задачи, чтобы успеть оформить заказы и получить оборудование. Планирование следующего перерыва начинается сразу после завершения предыдущего.

**20.1.3 Руководство**

Руководитель полета отвечает за создание объявлений, планирование запросов на выполнение работ, принятие решений и мониторинг выполнения задач. Это должен быть старший системный администратор, способный оценить предложения и увидеть зависимости.

**20.1.4 Управление предложениями изменений**

Предложения изменений должны быть поданы за неделю до перерыва. Используйте область с контролем версий для управления предложениями. Форма предложения должна включать информацию о изменениях, машинах, условиях, зависимостях, времени выполнения и процедурах тестирования.

**20.1.5 Разработка общего плана**

За неделю до перерыва руководитель полета блокирует предложения изменений и разрабатывает общий план, учитывающий все условия, сроки и требования.

**20.1.6 Отключение доступа**

Первая задача в ходе перерыва — отключение доступа к системе и уведомление пользователей. Разместите объявления, отключите удаленный доступ и измените сообщения в голосовой почте.

**20.1.7 Обеспечение механизмов и координации**

Для успешного перерыва важна координация и использование ключевых технологий, таких как коммутаторы KVM, последовательные консольные серверы и радиостанции.

**20.1.8 Предельные сроки завершения изменения**

Руководитель полета отслеживает прогресс и принимает решения о завершении задач. Важно учитывать уровень усталости группы и при необходимости начать выполнение плана отмены.

**20.1.9 Полное тестирование системы**

После завершения перерыва проводится полное тестирование системы. Начинайте с отключения всех машин, затем следуйте последовательности загрузки. Разделите машины на группы для тестирования и используйте цветные наклейки для отметки исправных и проблемных машин.

**20.1.10 Общение после обслуживания**

После завершения работ руководитель полета отправляет информационное сообщение по компании, сообщая о восстановлении нормальной работы.

**20.1.11 Возобновите удаленный доступ**

Верните удаленный доступ и восстановите сообщение на автоответчике службы поддержки. Это должно быть последним действием перед уходом из здания.

**20.1.12 Будьте на виду следующим утром**

После перерыва вся группа системных администраторов должна прийти на работу рано и быть на виду в компании, чтобы показать готовность к решению проблем.

**20.1.13 Обсуждение итогов**

Приблизительно к обеду следующего дня обсудите оставшиеся проблемы. Это поможет улучшить проведение будущих перерывов.

**20.2 Тонкости**

Для повышения эффективности технических перерывов полезно учитывать некоторые тонкости, такие как обучение нового руководителя полета, анализ данных с предыдущих перерывов и предоставление ограниченной доступности.

**20.2.1 Обучение нового руководителя полета**

Обучение новых руководителей полета важно для обеспечения преемственности. Новый руководитель может заранее ознакомиться с планом и учиться у текущего руководителя.

**20.2.2 Анализ тенденций в данных истории**

Анализ данных с предыдущих перерывов помогает улучшить планирование будущих перерывов. Записывайте фактическое время выполнения задач для улучшения процесса.

**20.2.3 Предоставление ограниченной доступности**

На некоторых этапах может потребоваться поддерживать доступность служб для определенной группы пользователей во время перерыва. Это может потребовать изменения архитектуры службы или добавления уровней избыточности.

**20.2.4 Компании высокой доступности**

Компании высокой доступности не могут позволить себе крупные отключения и должны обеспечить наличие избыточных систем. Технические перерывы в таких компаниях имеют свои особенности и требуют тщательного планирования.

**20.3 Заключение**

Основные аспекты успешного проведения технического перерыва — это подготовка, выполнение и работа с пользователями после завершения работ. Важно тщательно планировать и координировать действия, а также использовать надежную инфраструктуру.

### Глава 21. Централизация и децентрализация

Централизация означает наличие единой точки управления, а децентрализация — распределение контроля по нескольким элементам. Оба подхода имеют свои преимущества и могут быть реализованы с элементами другого подхода.

**21.1 Основы**

Организации часто меняют степень централизации и децентрализации в зависимости от внутренних изменений, слияний или расширения. Важно учитывать принципы, такие как решение проблем, мотивацию, опыт, участие, реализм, баланс, доступ и отсутствие давления.

**21.1.1 Руководящие принципы**

При решении о централизации или децентрализации важно четко определить проблему, понимать мотивацию, использовать опыт, прислушиваться к мнению пользователей, быть реалистом, найти баланс, обеспечить доступ и избегать давления.

**21.1.2 Кандидатуры для централизации**

Централизация подходит для распределенных систем, консолидации служб и хранилищ информации. Она снижает накладные расходы и делает управление более простым.

**21.1.3 Кандидатуры для децентрализации**

Децентрализация подходит для повышения устойчивости к отказам, удовлетворения потребностей пользователей и создания индивидуальных решений. Она может привести к множеству точек отказа, но правильно организованная централизация может повысить устойчивость.

**21.2 Тонкости**

Переход к централизованной или децентрализованной системе часто требует серьезной перестройки. Важно предложить решение, которое не только дешевле, но и лучше для пользователей.

**Пример: Объединение закупок**

Централизованная закупка привела к более быстрой доставке лучших продуктов за меньшие деньги. Группа системных администраторов контролировала все закупки, что позволило заблаговременно взаимодействовать с пользователями и выяснять их требования.

**21.2.2 Аутсорсинг**

Аутсорсинг — это процесс, при котором сторонним компаниям платят за выполнение технических услуг. Это помогает снизить внутренние конфликты, сосредоточиться на основном бизнесе и экономить за счет стандартизации. Однако важно тщательно прописывать требования в контракте, избегать неопытности при экстренных решениях и учитывать скрытые расходы.

**21.3 Заключение**

Централизация и децентрализация — сложные концепции, и ни одна из них не является универсально правильным решением. Важно понимать, какую проблему вы хотите решить и что вами движет. Учиться на опыте других людей и внедрять изменения с ответственностью и планированием.

### Глава 22. Мониторинг служб

Мониторинг — важный элемент обеспечения надежного обслуживания. Существует два основных типа мониторинга: исторический и в реальном времени.

**22.1 Основы**

Мониторинг систем используется для обнаружения и устранения неполадок, определения источников проблем, предотвращения будущих сбоев и предоставления данных о достижениях системных администраторов.

**22.1.1 Исторический мониторинг**

Исторический мониторинг собирает данные о доступности и использовании для последующего анализа. Он включает сбор данных и их анализ, результаты могут показать, например, что веб-служба работала 99,99% времени. Данные об использовании важны для планирования ресурсов.

**22.1.2 Мониторинг в реальном времени**

Мониторинг в реальном времени предупреждает о проблемах сразу после их возникновения. Он состоит из мониторинга и предупреждения. Мониторинг системы имеет смысл только в том случае, если информация о сбое будет передана ответственным лицам.

**22.1.2.1 SNMP**

SNMP — стандартный протокол для управления сетью, который используется для мониторинга устройств. Он включает запросы GET и PUT, а также ловушки для уведомлений. Важно обеспечить безопасность использования SNMP.

**22.1.2.2 Механизм оповещения**

Механизм оповещения должен быть независим от компонентов под наблюдением. Электронная почта популярна, но не должна быть единственным средством. Важно разработать политику обработки сообщений и учитывать безопасность.

**22.1.2.3 Передача на более высокий уровень**

Политика передачи на более высокий уровень гарантирует, что проблема будет передана другому человеку, если не решена вовремя. Важно описать разные пути передачи для различных типов предупреждений.

**22.1.2.4 Системы активного мониторинга**

Системы активного мониторинга могут устранять некоторые проблемы автоматически, но их возможности ограничены временными мерами. Важно переходить от временных решений к постоянным.

**22.2 Тонкости**

Когда система мониторинга расширяется, важно обеспечить доступность для всех системных администраторов. Со временем могут появиться дополнительные задачи, такие как мониторинг транзакций и обнаружение новых устройств.

**22.2.1 Доступность**

Система мониторинга должна быть доступна для всей команды администраторов. Это повышает гибкость и эффективность.

**22.2.2 Тотальный мониторинг**

Идеальная система мониторинга должна охватывать все устройства и службы. Автоматизированная установка новых машин помогает внести их в систему мониторинга.

**22.2.3 Обнаружение устройств**

Система мониторинга, обнаруживающая новые устройства, полезна для тотального мониторинга и отладки проблем.

**22.2.4 Сквозное тестирование**

Сквозное тестирование проверяет всю транзакцию, как если бы её выполнял пользователь. Это помогает выявить проблемы, которые могут быть не замечены в процессе обычного мониторинга.

**22.2.5 Мониторинг времени ответа приложений**

Мониторинг времени ответа приложений важен для обеспечения хорошего пользовательского опыта. Это дополнение к сквозному тестированию.

**22.2.6 Расширение**

При увеличении числа наблюдаемых объектов система мониторинга может испытывать трудности. Использование удаленных зондов и эффективное управление приоритетами помогают справиться с этими проблемами.

**22.2.7 Метамониторинг**

Метамониторинг — это мониторинг самой системы мониторинга. Он помогает удостовериться, что система работает корректно.

**Заключение**

Мониторинг систем важен для поддержания работоспособности. Исторический мониторинг и мониторинг в реальном времени помогают обнаруживать и устранять проблемы. Важно интегрировать дополнительные функции, такие как сквозное тестирование и мониторинг времени отклика приложений, чтобы поддерживать качество обслуживания на высоком уровне.